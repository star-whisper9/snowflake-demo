# 雪花算法 Demo

## 设计

### 一对多主从结构

应用内主从结构集成基础的分布式管理。单点主节点（低可用）。

**Master**

- WorkerList 维护、Worker 注册
- 对外提供 ID 端点

**Worker**

- 生成 ID

### 主从一体

Master 与 Worker 服务合并在同一应用，部署时按需配置启用（默认不启用任何服务）。允许单机部署（主从均启用，部署单一实例）。

### 交互设计

主从通过基础 REST 端点交互，未设计身份验证。内置心跳保活（Worker 心跳失败即刻停止对应 Worker 服务）。

### 分布式 Worker 部署

Worker 部署自动注册（正确配置主节点 REST 地址），注册成功才开启服务。注册（识别）根据 IP + Mac 组合确定同一机器，相同识别仅能部署一个服务。

### 雪花算法

使用原生雪花算法，41 位时间戳 + 10 位机器码 + 12 位序列号。允许自定义起始时间戳（默认 2024-08-12 08:12:00）。

支持配置回拨策略——拒绝生成（请求失败）或等待（有最大等待时间）。默认拒绝生成。

## Todo

- [x] 回拨策略
- [ ] 雪花算法位数配置支持
- [ ] *高可用设计*

*\* 短期内不考虑*

